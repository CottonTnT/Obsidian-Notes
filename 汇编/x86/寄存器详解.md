# 程序计数器相关

## CS

> CS的全拼为“code segmet”,对应于内存中的存放代码的内存区域，用来存放内存代码段区域的入口地址（段基址）



## IP

>instruction pointer,下一条将要执行的指令在代码段中的偏移量

CPU在执行指令时，通过代码寄存器CS和指令指针寄存器IP（instruction Pointer）来确定要执行的下一条指令的内存地址。

CS:IP 两个寄存器*指示了CPU当前读取的指令地址*，计算方式一般为*CS左移4位然后加上IP寄存器*，作为地址去取内容。

CPU的制造商会为这两个寄存器设置出厂初始值，这2个初始值，其实就决定了第一条执行指令的地址，这是所有程序的源头，没有这个初始值，多么复杂精妙的程序都没用，因为CPU压根就不会鸟你。随着X86的发展，第一条指令并不是一成不变的，

1. 8086：CPU reset后CS寄存器的值为0xFFFF，IP寄存器的值为0，所以将CS左移4位+IP，换算出的物理地址为0xFFFF0，这个地址就是1MB往下16字节的位置。

2. 80286：CPU reset之后CS的只为0xF000，IP的只为0xFFF0，算法同样是CS左移4位+IP，计算出的物理地址也是0xFFFF0

3. 80386：到了386年代，一切都变了，此时CPU reset后CS的只为0xF000，但是CS除了段选择之外还有一个隐藏的基址寄存器，这个寄存器的值为0xFFFF0000，IP的值仍然为0xFFF0，此时的计算算法也不是上面的左移4位了，而是0xFFFF0000 + 0xFFF0 = 0xFFFFFFF0	 ，这个地址已经是很高的地址了，是4G往下16字节的位置。

## PC
> program counter, PC是非intel厂家对IP的称呼，也就是说PC起始跟CS:IP是一回事儿。